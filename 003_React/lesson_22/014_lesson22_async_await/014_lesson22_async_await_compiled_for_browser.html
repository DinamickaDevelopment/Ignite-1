<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>ES6/7</title> 

    <script> 
        function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { return step("next", value); }, function (err) { return step("throw", err); }); } } return step("next"); }); }; }

        window.onload = function () {
            let main = (() => {
                var _ref = _asyncToGenerator(function* () {
                    var greeting = yield getText();

                    document.write(greeting);
                });

                    return function main() {
                        return _ref.apply(this, arguments);
                    };
                })();

                function getText() {

                    return new Promise(function (resolve, reject) {
                        var xhr = new XMLHttpRequest();
                        xhr.open('GET', 'hello.html');
                        setTimeout(function () {
                            xhr.send();
                        }, 1000);

                        xhr.onload = function () {
                            if (this.status == 200) {
                                resolve(this.response);
                            } else {
                                var error = new Error(this.statusText);
                                error.code = this.status;
                                reject(error);
                            }
                        };

                        xhr.onerror = function () {
                            reject(new Error("Network Error"));
                        };
                    });
                }

                main();
            };
    </script>
</head>
<body>
    <p>Wait...</p>
</body>
</html>